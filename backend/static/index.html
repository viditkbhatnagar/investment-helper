<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Investment Advisor (Demo)</title>
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin: 2rem; }
      input, select, button { padding: 8px; margin: 4px; }
      table { border-collapse: collapse; width: 100%; }
      th, td { border: 1px solid #ddd; padding: 8px; }
    </style>
  </head>
  <body>
    <h1>Investment Advisor API Demo</h1>
    <section>
      <h3>Quick Quotes</h3>
      <input id="tickers" placeholder="RELIANCE,TCS,INFY" value="RELIANCE,TCS,INFY" />
      <button onclick="loadQuotes()">Fetch</button>
      <table id="quotes"></table>
    </section>

    <section>
      <h3>Recommendations</h3>
      <label>Budget (â‚¹): <input id="budget" type="number" value="100000"></label>
      <label>Horizon (years):
        <select id="horizon">
          <option>1</option>
          <option>3</option>
          <option>5</option>
        </select>
      </label>
      <label>Risk:
        <select id="risk">
          <option>Moderate</option>
          <option>Conservative</option>
          <option>Aggressive</option>
        </select>
      </label>
      <button onclick="loadRecs()">Recommend</button>
      <table id="recs"></table>
    </section>

    <script>
      async function loadQuotes() {
        const tickers = document.getElementById('tickers').value;
        const res = await fetch(`/api/quotes?tickers=${encodeURIComponent(tickers)}`);
        const data = await res.json();
        const tbl = document.getElementById('quotes');
        tbl.innerHTML = '';
        if (!data.rows || data.rows.length === 0) return;
        const headers = Object.keys(data.rows[0]);
        tbl.insertAdjacentHTML('beforeend', `<tr>${headers.map(h=>`<th>${h}</th>`).join('')}</tr>`);
        for (const r of data.rows) {
          tbl.insertAdjacentHTML('beforeend', `<tr>${headers.map(h=>`<td>${r[h]}</td>`).join('')}</tr>`);
        }
      }

      async function loadRecs() {
        const body = {
          budget: parseInt(document.getElementById('budget').value, 10),
          horizon: parseInt(document.getElementById('horizon').value, 10),
          risk: document.getElementById('risk').value,
          products: ["Stocks", "Mutual Funds"]
        };
        const res = await fetch('/api/recommendations', {
          method: 'POST', headers: {'Content-Type': 'application/json'},
          body: JSON.stringify(body)
        });
        const data = await res.json();
        const tbl = document.getElementById('recs');
        tbl.innerHTML = '';
        if (!data.portfolio || data.portfolio.length === 0) return;
        const headers = Object.keys(data.portfolio[0]);
        tbl.insertAdjacentHTML('beforeend', `<tr>${headers.map(h=>`<th>${h}</th>`).join('')}</tr>`);
        for (const r of data.portfolio) {
          tbl.insertAdjacentHTML('beforeend', `<tr>${headers.map(h=>`<td>${r[h]}</td>`).join('')}</tr>`);
        }
      }
    </script>
  </body>
  </html>


